<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Feed ‚Ä¢ Insta Clone</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#fafafa;--card:#fff;--muted:#8e8e8e;--accent:#3897f0}
        *{box-sizing:border-box;font-family:Inter,system-ui,Arial,sans-serif}
        body{margin:0;background:var(--bg);color:#111}
        .nav{height:60px;background:#fff;border-bottom:1px solid #dbdbdb;display:flex;align-items:center;justify-content:space-between;padding:0 18px;position:sticky;top:0;z-index:10}
        .nav .logo{font-weight:700;font-size:20px}
        .container{max-width:980px;margin:28px auto;display:flex;gap:28px;padding:0 18px}
        .feed{flex:1}
        .sidebar{width:300px}
        .post{background:var(--card);border:1px solid #dbdbdb;margin-bottom:20px;border-radius:6px}
        .post .header{display:flex;align-items:center;padding:12px}
        .avatar{width:40px;height:40px;border-radius:50%;background:#ccc;margin-right:12px;flex-shrink:0}
        .post img.media{width:100%;height:auto;display:block}
        .actions{display:flex;gap:12px;padding:10px}
        .actions button{background:none;border:0;cursor:pointer;font-size:18px}
        .meta{padding:0 12px 12px}
        .caption{color:#111;margin-top:6px}
        .muted{color:var(--muted);font-size:13px}
        .card{background:var(--card);border:1px solid #dbdbdb;padding:14px;border-radius:6px}
        .center{display:flex;align-items:center;gap:12px}
        a {color:inherit;text-decoration:none}
        @media(max-width:900px){.container{flex-direction:column;padding:0 12px}.sidebar{width:100%}}
    </style>
</head>
<body>
    <header class="nav">
        <div class="logo"><a href="/">InstaClone</a></div>
        <nav class="center">
            <a href="/">Home</a>
            <a href="/create" style="margin-left:14px">New</a>
            <% if (user) { %>
              <a href="/auth/profile" style="margin-left:14px">@<%= user.username %></a>
            <% } else { %>
              <span style="margin-left:14px">@guest</span>
            <% } %>
            <a href="/auth/logout" style="margin-left:14px">Logout</a>
        </nav>
    </header>

    <main class="container">
        <section class="feed">
            <% if (!posts || posts.length === 0) { %>
                <div class="card">No posts yet. Follow users or create a post.</div>
            <% } %>

            <% posts && posts.forEach(function(post){ %>
                <article class="post">
                    <div class="header">
                        <div class="avatar"></div>
                        <div>
                            <div style="font-weight:600"><%= (post.user && post.user.username) ? post.user.username : (post.username || 'user') %></div>
                            <div class="muted" style="font-size:12px"><%= new Date(post.createdAt).toLocaleString() %></div>
                        </div>
                    </div>

                    <div>
                        <img class="media" src="<%= post.imagePath || post.imageUrl || '/uploads/' + post.filename %>" alt="post image">
                    </div>

                    <div class="meta">
                        <div class="actions">
                            <button title="Like">‚ù§Ô∏è</button>
                            <button title="Comment">üí¨</button>
                            <button title="Share">‚úàÔ∏è</button>
                        </div>
                        <div class="muted"><%= (post.likes && post.likes.length) ? post.likes.length + ' likes' : '0 likes' %></div>
                        <div class="caption"><strong><%= (post.user && post.user.username) ? post.user.username : (post.username || 'user') %></strong> <%= post.caption %></div>
                    </div>
                </article>
            <% }) %>
        </section>

    </main>
</body>
</html>
