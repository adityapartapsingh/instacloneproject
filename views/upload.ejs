<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Insta Clone</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body{font-family:Inter,system-ui,Arial,sans-serif;background:#fafafa;margin:0;color:#111}
        .hero{max-width:900px;margin:48px auto;padding:24px;background:#fff;border:1px solid #eee;border-radius:8px;text-align:center}
        .btn{display:inline-block;padding:10px 16px;border-radius:6px;background:#3897f0;color:#fff;text-decoration:none;margin:8px}
        .muted{color:#8e8e8e}
    </style>
</head>
<body>
    <header class="nav">
        <div class="logo"><a href="/">InstaClone</a></div>
        <div class="center">
            <input aria-label="Search" placeholder="Search" style="padding:8px 10px;border:1px solid #dbdbdb;border-radius:6px;min-width:180px">
        </div>
        <nav class="center">
            <a href="/">Home</a>
            <a href="/auth/create" style="margin-left:14px">New</a>
            @<%= user ? user.username : 'guest' %>
            <a href="/auth/logout" style="margin-left:14px">Logout</a>
        </nav>
    </header>

        <main class="hero">
        <h1 style="font-size:28px;margin:0 0 8px 0">Welcome to Insta Clone</h1>
        <p class="muted" style="margin:0 0 18px 0">A simple Instagram-like app built with Node.js and Express.</p>
        <div>
                        <% if (!user) { %>
                            <a class="btn" href="/auth/register">Sign up</a>
                            <a class="btn" style="background:#fff;color:#111;border:1px solid #dbdbdb" href="/auth/login">Log in</a>
                        <% } else { %>
                            <span class="muted">Signed in as <strong><%= user.username %></strong></span>
                        <% } %>
        </div>

                <% if (user) { %>
                    <section style="margin-top:18px;text-align:left">
                        <h3 style="margin:0 0 8px 0">Create Post</h3>
                        <form action="/create" method="POST" enctype="multipart/form-data" style="display:flex;gap:8px;align-items:center">
                            <input type="text" name="caption" placeholder="Write a caption..." style="flex:1;padding:8px;border:1px solid #ddd;border-radius:6px">
                            <input type="file" name="postImage" accept="image/*" style="padding:6px">
                            <button class="btn" type="submit">Upload</button>
                        </form>
                    </section>
                <% } %>

                <% if (posts && posts.length) { %>
            <section style="margin-top:24px;text-align:left">
                <h2 style="margin:0 0 12px 0">Recent Posts</h2>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px">
                    <% posts.forEach(function(post){ %>
                        <a href="/post/<%= post._id %>" style="display:block;background:#fff;border:1px solid #eee;padding:8px;border-radius:6px;text-decoration:none;color:inherit">
                            <img src="<%= post.imagePath %>" alt="post" style="width:100%;height:140px;object-fit:cover;border-radius:4px;margin-bottom:8px">
                            <div style="font-weight:600"><%= post.caption ? (post.caption.substring(0,60)) : 'No caption' %></div>
                        </a>
                    <% }) %>
                </div>
            </section>
        <% } %>
    </main>
</body>
</html>
</html>